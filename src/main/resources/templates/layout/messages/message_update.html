<!DOCTYPE html>
<html lang="en" th:replace="~{layout/main-layout:: main-fragment(
    ~{::title},
    ~{::main},
    ~{::#css-static-resource},
    ~{::#js-static-resource}
)}" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <title>Messages</title>
    <th:block id="css-static-resource">
        <script src="https://cdn.ckeditor.com/ckeditor5/41.3.1/classic/ckeditor.js"></script>
    </th:block>
</head>

<body>
<main class="min-vh-100 bg-light py-3">
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a th:href="@{/messages}">Messages</a></li>
            <li class="breadcrumb-item">Update</li>
        </ol>
    </nav>
    <h3>#Update Messages</h3>

    <form class="row" method="post" th:action="@{/messages/update}" th:object="${message}">
        <div class="row">
            <div class="mb-3 col-md-6">
                <label class="form-label" for="subjectname">Subject name</label>
                <input class="form-control" id="subjectname" name="subject" placeholder="Subject email"
                       th:field="*{subject}" type="text">
                <div class="text-danger h6 mt-1" th:errors="*{subject}" th:if="${#fields.hasErrors('subject')}"></div>
            </div>
            <div class="mb-3 col-md-6">
                <label class="form-label" for="senderName">Sender name</label>
                <input class="form-control" id="senderName" placeholder="HR Management" th:field="*{senderName}"
                       type="text">
                <div class="text-danger h6 mt-1" th:errors="*{senderName}"
                     th:if="${#fields.hasErrors('senderName')}"></div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12 mb-3">
                <label class="form-label" for="editor">Message <small>[{{name}}, {{age}}, {{address}}, {{code}}, {{email}}, {{phone}}, {{username}}, {{username}}, {{username}}, {{department}}, {{position}}]</small> </label>
                <textarea class="form-control" id="editor" name="message" rows="3" th:field="*{message}"></textarea>
                <div class="text-danger h6 mt-1" th:errors="*{message}" th:if="${#fields.hasErrors('message')}"></div>
            </div>
        </div>
        <div class="row">
            <div class="mb-3 col-md-12">
                <label class="form-label" for="publishAt">Send time</label>
                <input class="form-control" id="publishAt" name="publishAt" th:field="*{publishAt}"
                       type="datetime-local">
                <div class="text-danger h6 mt-1" th:errors="*{publishAt}"
                     th:if="${#fields.hasErrors('publishAt')}"></div>
            </div>
        </div>
        <div class="row" id="emailValue" th:if="${message.choice == false}">
            <div class="col-md-12 mb-3">
                <label class="form-label" for="list-email">List email</label>
                <textarea autocomplete="on" class="form-control" id="list-email" name="listEmail" rows="3"
                          th:field="*{listMail}"></textarea>
                <div class="text-danger h6 mt-1" th:errors="*{listMail}" th:if="${#fields.hasErrors('listMail')}"></div>
            </div>
        </div>
        <div class="row" id="groupValue" th:if="${message.choice == true}">
            <div class="col-md-12 mb-3">
                <label class="form-label" for="group-email">Group email (from <a
                        th:href="@{/groups}">here</a>)</label>
                <select aria-label="Default select example" class="form-select" id="group-email" name="groupId"
                        th:field="*{groupId}">
                    <option value="0">Choose a group</option>
                    <option th:each="group: ${session.groups}" th:text="${group.name}" th:value="${group.id}">
                        Intership group
                    </option>
                </select>
                <div class="text-danger h6 mt-1" th:errors="*{groupId}" th:if="${#fields.hasErrors('groupId')}"></div>
            </div>
        </div>
        <div class="row">
            <div class="mb-3 col-md-12">
                <button class="btn btn-primary" type="submit">Update</button>
                <input name="id" th:value="${message.id}" type="hidden">
                <input name="choice" th:value="${message.choice}" type="hidden">
            </div>
        </div>
    </form>
</main>
<th:block id="js-static-resource">
    <script type="application/javascript">
        ClassicEditor
            .create(document.querySelector('#editor'))
            .catch(error => {
                console.error(error);
            });

        var now = new Date();
        // Định dạng ngày và giờ hiện tại thành chuỗi cho trường datetime-local
        var formattedNow = now.toISOString().slice(0, 16);
        // Đặt minDate cho trường datetime-local
        document.getElementById("publishAt").min = formattedNow;

        // var radioGroup = document.getElementById("radio-btn-group");
        // var radioEmail = document.getElementById("radio-btn-email");
        // var emailValue = document.getElementById("emailValue");
        // var groupValue = document.getElementById("groupValue");
        //
        // if (radioGroup.checked) {
        //     groupValue.style.display = "block";
        //     emailValue.style.display = "none";
        // } else if (radioEmail.checked) {
        //     emailValue.style.display = "block";
        //     groupValue.style.display = "none";
        // }
        //
        // radioGroup.addEventListener("change", function () {
        //     if (radioGroup.checked) {
        //         groupValue.style.display = "block";
        //         emailValue.style.display = "none";
        //     }
        // });
        //
        // radioEmail.addEventListener("change", function () {
        //     if (radioEmail.checked) {
        //         emailValue.style.display = "block";
        //         groupValue.style.display = "none";
        //     }
        // });
    </script>
</th:block>
</body>